{{! templates/item-v2.hbs - Updated for all item types }}
<div class="item-sheet-container">
    <header class="sheet-header">
        <img src="{{item.img}}" data-edit="img" title="{{item.name}}" height="64" width="64"/>
        <h1><input name="name" type="text" value="{{item.name}}" placeholder="Item Name"/></h1>
    </header>

    <section class="sheet-body">
        {{! Weapon-specific fields }}
        {{#if (eq item.type "weapon")}}
            <div class="form-group">
                <label>Weapon Type</label>
                <select name="system.weaponType" data-action="updateWeaponType">
                    {{#each WEAPON_TYPES as |type id|}}
                        <option value="{{id}}" {{#if (eq ../system.weaponType id)}}selected{{/if}}>{{type.label}}</option>
                    {{/each}}
                </select>
            </div>

            {{#if (or (eq system.weaponType "hand") (eq system.weaponType "long"))}}
            <div class="form-group">
                <label>Two-Handed</label>
                <input type="checkbox" name="system.isTwoHanded" data-action="toggleTwoHanded" {{checked system.isTwoHanded}}/>
                <span>Use weapon with both hands for +1 damage</span>
            </div>
            {{/if}}

            {{#if (eq system.weaponType "throwing")}}
            <div class="form-group">
                <label>In Melee Range</label>
                <input type="checkbox" name="system.inMelee" data-action="toggleInMelee" {{checked system.inMelee}}/>
                <span>Weapon is being used in melee combat (-1 damage penalty)</span>
            </div>
            {{/if}}

            <div class="form-group">
                <label>Equipped</label>
                <input type="checkbox" name="system.equipped" data-action="toggleEquipped" {{checked system.equipped}}/>
                <span>Show this weapon for quick rolling</span>
            </div>
        {{/if}}

        {{! Armor-specific fields }}
        {{#if (eq item.type "armor")}}
            <div class="form-group">
                <label>Armor Type</label>
                <select name="system.armorType" data-action="updateArmorType">
                    {{#each ARMOR_TYPES as |type id|}}
                        <option value="{{id}}" {{#if (eq ../system.armorType id)}}selected{{/if}}>{{type.label}}</option>
                    {{/each}}
                </select>
            </div>
            <div class="form-group">
                <label>Equipped</label>
                <input type="checkbox" name="system.equipped" data-action="toggleEquipped" {{checked system.equipped}}/>
                <span>This {{#if (eq system.armorType "shield")}}shield{{else}}armor{{/if}} is currently worn</span>
            </div>
        {{/if}}

        {{! Advancement-specific fields }}
        {{#if (eq item.type "advancement")}}
            <div class="form-group">
                <label>Advancement Type</label>
                <select name="system.advancementType" data-action="updateAdvancementType">
                    {{#each ADVANCEMENT_TYPES as |type id|}}
                        <option value="{{id}}" {{#if (eq ../system.advancementType id)}}selected{{/if}}>{{type.label}}</option>
                    {{/each}}
                </select>
            </div>

            <div class="form-group">
                <label>Roll Formula</label>
                <input type="text" name="system.rollFormula" value="{{system.rollFormula}}" placeholder="1d20"/>
                <small>Base dice to roll (e.g., 1d20, 2d6, 1d10+2)</small>
            </div>

            <div class="form-group">
                <label>Uses Attribute</label>
                <select name="system.usesAttribute">
                    <option value="none" {{#if (eq system.usesAttribute "none")}}selected{{/if}}>None</option>
                    <option value="brawn" {{#if (eq system.usesAttribute "brawn")}}selected{{/if}}>Brawn</option>
                    <option value="wit" {{#if (eq system.usesAttribute "wit")}}selected{{/if}}>Wit</option>
                    <option value="will" {{#if (eq system.usesAttribute "will")}}selected{{/if}}>Will</option>
                </select>
                <small>Add this attribute modifier to the roll</small>
            </div>

            <div class="form-group">
                <label>Equipped</label>
                <input type="checkbox" name="system.equipped" data-action="toggleEquipped" {{checked system.equipped}}/>
                <span>Show this ability for quick rolling</span>
            </div>
        {{/if}}

        {{! Consequence-specific fields }}
        {{#if (eq item.type "consequence")}}
            <div class="form-group">
                <label>Consequence Type</label>
                <select name="system.consequenceType" data-action="updateConsequenceType">
                    {{#each CONSEQUENCE_TYPES as |type id|}}
                        <option value="{{id}}" {{#if (eq ../system.consequenceType id)}}selected{{/if}}>{{type.label}}</option>
                    {{/each}}
                </select>
            </div>

            <div class="form-group">
                <label>Roll Formula</label>
                <input type="text" name="system.rollFormula" value="{{system.rollFormula}}" placeholder="1d20"/>
                <small>Base dice to roll (e.g., 1d20, 2d6, 1d10+2)</small>
            </div>

            <div class="form-group">
                <label>Uses Attribute</label>
                <select name="system.usesAttribute">
                    <option value="none" {{#if (eq system.usesAttribute "none")}}selected{{/if}}>None</option>
                    <option value="brawn" {{#if (eq system.usesAttribute "brawn")}}selected{{/if}}>Brawn</option>
                    <option value="wit" {{#if (eq system.usesAttribute "wit")}}selected{{/if}}>Wit</option>
                    <option value="will" {{#if (eq system.usesAttribute "will")}}selected{{/if}}>Will</option>
                </select>
                <small>Add this attribute modifier to the roll</small>
            </div>

            <div class="form-group">
                <label>Active</label>
                <input type="checkbox" name="system.active" data-action="toggleActive" {{checked system.active}}/>
                <span>This consequence is currently affecting the character</span>
            </div>
        {{/if}}

        {{! Loot-specific fields }}
        {{#if (eq item.type "loot")}}
            <div class="form-group">
                <label>Loot Type</label>
                <select name="system.lootType" data-action="updateLootType">
                    {{#each LOOT_TYPES as |type id|}}
                        <option value="{{id}}" {{#if (eq ../system.lootType id)}}selected{{/if}}>{{type.label}}</option>
                    {{/each}}
                </select>
            </div>

            <div class="form-group">
                <label>Value (Gold Pieces)</label>
                <input type="number" name="system.value" value="{{system.value}}" min="0" step="0.01"/>
                <small>Monetary value in gold pieces</small>
            </div>
        {{/if}}

        {{! Description field for all items }}
        <div class="form-group">
            <label>Description</label>
            {{editor system.description target="system.description" button=true owner=owner editable=editable}}
        </div>
    </section>
</div>